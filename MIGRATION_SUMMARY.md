# ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Vercel KV –∏ Blob Storage –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
npm install @vercel/kv @vercel/blob bcryptjs
npm install --save-dev @types/bcryptjs
```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel

–î–æ–±–∞–≤—å—Ç–µ –≤ Vercel Dashboard ‚Üí Settings ‚Üí Environment Variables:

1. **KV_REST_API_URL** - –∏–∑ Vercel KV Dashboard
2. **KV_REST_API_TOKEN** - –∏–∑ Vercel KV Dashboard  
3. **BLOB_READ_WRITE_TOKEN** - –∏–∑ Vercel Blob Dashboard

## üìù –ß—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### ‚úÖ –°–æ–∑–¥–∞–Ω–æ:
- `lib/vercel/kv.ts` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å KV (Redis)
- `lib/vercel/blob.ts` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Blob Storage
- `lib/auth-session.ts` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ —á–µ—Ä–µ–∑ cookies

### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ:
- `app/api/auth/login/route.ts` - –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ KV
- `app/api/auth/register/route.ts` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ KV
- `app/api/auth/telegram/route.ts` - Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ KV
- `app/api/auth/logout/route.ts` - –≤—ã—Ö–æ–¥ (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
- `app/api/profile/avatar/route.ts` - –∑–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–æ–≤ –≤ Blob
- `app/api/profile/data/route.ts` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è –∏–∑ KV
- `app/api/referrals/generate/route.ts` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤
- `app/api/telegram/webhook/route.ts` - –æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ–¥ KV
- `components/providers/AuthProvider.tsx` - –Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `lib/auth.ts` - –ø–µ—Ä–µ–¥–µ–ª–∞–Ω –ø–æ–¥ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
- `package.json` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `env.local.example` - –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### ‚ùå –£–¥–∞–ª–µ–Ω–æ:
- `lib/supabase/client.ts`
- `lib/supabase/server.ts`
- `lib/hooks/useSupabase.ts`

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ KV

–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ:

- `user:{id}` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `user:email:{email}` - –∏–Ω–¥–µ–∫—Å email ‚Üí user_id
- `user:telegram:{telegram_id}` - –∏–Ω–¥–µ–∫—Å telegram_id ‚Üí user_id
- `session:{session_id}` - —Å–µ—Å—Å–∏–∏ (TTL 30 –¥–Ω–µ–π)
- `sessions:user:{user_id}` - —Å–ø–∏—Å–æ–∫ —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `enrollment:{id}` - –∑–∞–ø–∏—Å–∏ –æ –∫—É—Ä—Å–∞—Ö
- `enrollments:user:{user_id}` - –∫—É—Ä—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `balance:user:{user_id}` - –±–∞–ª–∞–Ω—Å
- `referral:{id}` - —Ä–µ—Ñ–µ—Ä–∞–ª—ã
- `referrals:user:{user_id}` - —Ä–µ—Ñ–µ—Ä–∞–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `transaction:{id}` - —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- `transactions:user:{user_id}` - —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üîê –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

- –°–µ—Å—Å–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ cookies (`session_id`)
- –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ bcryptjs
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ç–µ–∫—à–∏—Ö —Å–µ—Å—Å–∏–π (TTL)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ email/password –∏ Telegram

## üìÅ –•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

- –ê–≤–∞—Ç–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ Vercel Blob Storage
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∞–≤–∞—Ç–∞—Ä–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤—ã—Ö
- –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º —á–µ—Ä–µ–∑ URL

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `npm install`
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel Dashboard**
3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è**
4. **–°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase –Ω—É–∂–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é** (–µ—Å–ª–∏ –µ—Å—Ç—å)

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel, –ø—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.
